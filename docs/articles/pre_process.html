<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pre-Processing with efdcr • efdcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pre-Processing with efdcr">
<meta property="og:description" content="efdcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">efdcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/efdcr_intro.html">Introduction of efdcr</a>
    </li>
    <li>
      <a href="../articles/pre_process.html">Pre-Processing with efdcr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hxfan1227/efdcr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pre_process_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="pre_process_files/jquery-1.12.4/jquery.min.js"></script><link href="pre_process_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="pre_process_files/datatables-binding-0.13/datatables.js"></script><link href="pre_process_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="pre_process_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="pre_process_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="pre_process_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="pre_process_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pre-Processing with efdcr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hxfan1227/efdcr/blob/master/vignettes/pre_process.Rmd"><code>vignettes/pre_process.Rmd</code></a></small>
      <div class="hidden name"><code>pre_process.Rmd</code></div>

    </div>

    
    
<div id="pre-process-with-efdcr" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-process-with-efdcr" class="anchor"></a>Pre-process with <code>efdcr</code>
</h2>
<p>The time series data used by EEMS or EFDC is usually saved in <code>.wq</code> format, which is a text file with first line be the number of data points and the other lines be the time series data. The data lines will be repeated for all data points. Frankly, it is a simple and clear data structure but not tidy. Hence I design the <code><a href="../reference/dt_to_wq.html">dt_to_wq()</a></code> function to handle that issue.</p>
<div id="hydrological-data" class="section level3">
<h3 class="hasAnchor">
<a href="#hydrological-data" class="anchor"></a>Hydrological Data</h3>
<p>Below is the <code>tidy</code> hydrological data, with <code>Date</code> column as the index. I suggest you store your hydrological data in this kind of format and then use the <code><a href="../reference/dt_to_wq.html">dt_to_wq()</a></code> function to convert it into <code>.wq</code> files.</p>
<div id="htmlwidget-800667508d58381a0937" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-800667508d58381a0937">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],["1953-01-01","1953-01-02","1953-01-03","1953-01-04","1953-01-05","1953-01-06","1953-01-07","1953-01-08","1953-01-09","1953-01-10","1953-01-11","1953-01-12","1953-01-13","1953-01-14","1953-01-15","1953-01-16","1953-01-17","1953-01-18","1953-01-19","1953-01-20","1953-01-21","1953-01-22","1953-01-23","1953-01-24","1953-01-25","1953-01-26","1953-01-27","1953-01-28","1953-01-29","1953-01-30","1953-01-31"],[511,625,619,591,524,480,450,428,405,398,386,367,377,380,366,360,380,395,352,350,372,380,440,482,548,610,717,1330,2300,2390,2270],[96,84,80.3,75.2,92,88,86,84,84,82,78.5,70.1,66.7,68.4,70.1,70.1,76.9,80.3,82,84,88,121,152,133,127,190,752,1250,734,453,334],[75.6,69.3,67.2,63,61,57,55,57,55,55,55,55,53,55,55,59,63,77.7,86.1,96.6,103,105,109,109,124,337,1580,1620,791,461,355],[39.6,40.6,38.8,36.8,33.6,34.8,33.2,34,33.6,30.9,30.9,31.3,31.7,32.1,32.8,34,35.6,35.6,35.6,36,37.2,36,36.8,36.8,59.4,407.9,681,396,240.5,173.8,142.7],[74.25928,76.5436,76.5436,71.97496,69.69064,69.69064,67.40632,67.40632,67.40632,65.122,62.83768,62.83768,60.55336,62.83768,67.40632,69.69064,62.83768,69.69064,69.69064,69.69064,76.5436,76.5436,76.5436,74.25928,95.19888,495.3356,815.1404,415.3844,235.68456,167.15496,154.5912]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date<\/th>\n      <th>Ganjiang_Q<\/th>\n      <th>Fuhe_Q<\/th>\n      <th>Xinjiang_Q<\/th>\n      <th>Raohe_Q<\/th>\n      <th>Xiushui_Q<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Now we can convert it to <code>.wq</code> files.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="../reference/dt_to_wq.html">dt_to_wq</a></span>(<span class="kw">measure.vars</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Ganjiang_Q'</span>, <span class="st">'Fuhe_Q'</span>), <span class="kw">src.dt</span> <span class="kw">=</span> <span class="no">PYL_Hydro</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="st">'D:'</span>,
         <span class="kw">start.date</span> <span class="kw">=</span> <span class="st">'1953-01-01'</span>, <span class="kw">end.date</span> <span class="kw">=</span> <span class="st">'1953-01-20'</span>, <span class="kw">interval</span> <span class="kw">=</span> <span class="st">'1 day'</span>)</pre></body></html></div>
<p>Then you will find 2 <code>.wq</code> files in your path (‘D:’ in this case). After that you can use the <code>import</code> button in EEMS when setting the boundaries. It will save you much time.</p>
</div>
<div id="water-quality-data" class="section level3">
<h3 class="hasAnchor">
<a href="#water-quality-data" class="anchor"></a>Water quality data</h3>
<p>Compared to other boundaires, prepare the water quality boundaries (i.e., cwqsrs01-21.inp) is the most trival thing when buidling a water enviroment model. However, the EEMS seems to have bugs in reading the water quality boundaies, i.e., it can not import the cwqsrsXX.inp files at once. Consequently, I come up with the <code><a href="../reference/set_wqbc.html">set_wqbc()</a></code> function. To use the <code><a href="../reference/set_wqbc.html">set_wqbc()</a></code> function, you should first convert your water quality data to <code>.wq</code> files with the <code><a href="../reference/dt_to_wq.html">dt_to_wq()</a></code> function. After that you may easily prepare the 21 input files required by EEMS.</p>
<p>When use the <code><a href="../reference/dt_to_wq.html">dt_to_wq()</a></code> function with water quality data, you should store your water quality data in the format below:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/set_wqbc.html">set_wqbc</a></span>(<span class="kw">wq_path</span> <span class="kw">=</span> <span class="st">'D:/wqs'</span>, <span class="kw">cwqsrs_path</span> <span class="kw">=</span> <span class="st">'D:/cwqsrs'</span>)</pre></body></html></div>
<p>The <code>efdcr</code> package is mainly used for reading and visualizing the modeling results exported by the EEMS. Currently, only the <code>.nc</code> files exported by EEMS is supported.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hongxiang Fan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
